<app-header></app-header>

<div class="container h-auto mt-5">
 
<div class="row container ml-1">
  <div class=" mt-3 mb-2">
<h1 class="font_bold">Bienvenue {{currentuser.prenom}} sur votre panier</h1>
<p class="font_light" style="width: 400px;">Voir tout les produits qui vous les avez metté sur votre panier; Amusez-vous.</p>
</div></div>
<div class="row">
<div class="col-sm-6 col-md-9 col-lg-8 col-md-offset-1">
    <table class="table ">
        <thead>
            <tr>
                <th>Produuit</th>
                <th>Quantitée</th>
                <th class="text-center">Prix</th>
                <th class="text-center">Total</th>
                <th> </th>
            </tr>
        </thead>
        <div *ngIf="ordersnotfound" class="mt-2 text-muted"><p>Votre panier est vide, <a [routerLink]="['/all-products']" >remplis la</a> </p></div>
        <tbody *ngFor="let order of orders; let i= index">
            <tr>
              
                <td class="col-sm-8 col-md-6">
                <div class="media">
                    <img class="media-object " src="{{order.product?.img_1}}" style="width: 72px; height: 72px;">
                    <div class="media-body ml-2">
                        <h5 ><a  [routerLink]="['/products',order.product?._id, currentuser._id ]" style="color: rgb(49, 49, 49); text-decoration: none; font-size: 13px; " class="font_bold" >{{i+1}} - {{order?.product.name | uppercase}}</a></h5>
                        <p class=" blockquote-footer" style="font-size: 10px;">by: <a href="#" class="textlink" >COPRA SHOP</a></p>
                    </div>
                </div></td>
                <td class="col-sm-1 col-md-1" style="text-align: center">
                <input  class="form-control"  value="{{order.quantity}}">
                </td>
                <td class="col-sm-1 col-md-1 text-center "><h6 class="nbr_font font_bold mt-2">{{order.product.price | currency : 'MAD' }} </h6></td>
                <td class="col-sm-1 col-md-1 text-center "><h6 class="nbr_font font_bold mt-2" >{{order?.quantity * order?.product.price | currency : 'MAD' }}</h6> </td>
                <td class="col-sm-1 col-md-1">
                <button type="button" class="btn btn-sm btn-danger rounded-pill shadow text-right "  (click)="deleteorder(order?._id)"> <i class="fas fa-trash-alt"></i>
                </button></td>
            </tr><tr></tr>
        </tbody>
    </table>  
              
</div>
       
<div class="container col-lg-4 col-sm-12 mb-sm-5 " id="marginbtm" >
  <div class="card p-3  text-dark bg-light border-light" style="border-radius: 16px;box-shadow: -4px 20px 16px 6px #0000000d;">
    <div class="card-body">
      <h3 class="card-title font_bold mb-3 " style="font-size: 20px;">Résumé des commandes ({{countoforders}}) </h3>
      <p class="sizetxt mb-1 mt-4 " >Adresse de livraison <button class="btn btn-sm btn-light mb-2 rounded-circle float-right shadow " style="font-size: 12px;"><i class="far fa-edit"></i></button> </p>
      <p class="font_normale mt-3 mb-4" style="font-size: 12px;" >{{currentuser.addressedelivraison}}</p>

        <p class="sizetxt mb-1 " >Total globale</p> <h6 class="nbr_font font_bold mb-4" style="font-size: 24px;" >{{ totvalue  | currency : 'MAD' }} </h6> 
       <div *ngIf="!ordersnotfound">
         <ngx-paypal [config]="payPalConfig"></ngx-paypal>
       </div>
       <div *ngIf="ordersnotfound" >
         <h6 class="text-danger">Votre panier est vide</h6>
        <div style="filter: blur(3px); pointer-events: none;">
           <ngx-paypal [config]="payPalConfig"></ngx-paypal>
        </div>
      </div>
        <form [formGroup]="orderdetailForm" class="mb-2"  >
              <div *ngFor="let order of orders; let i = index">
              <input type="hidden" formControlName="quantity" id="quan{{i}}" [value]="order.quantity">
              <input type="hidden" formControlName="product" id="prod{{i}}" [value]="order.product?._id">
              </div>
              <input type="hidden" id="tot" formControlName="totalprice" [value]="totvalue">
              <input type="hidden" id="adr" formControlName="adresse" [value]="currentuser.addressedelivraison">
              <input type="hidden" formControlName="user">
          <button  type="button" data-toggle="modal" data-target="#exampleModalCenter" class="btn btn-sm rounded-pill shadow p-2 font_bold btncommande btn-block" ><i class="fas fa-money-bill-wave"></i>  Commander directement</button>
         </form>  
          
          <button type="button" class="btn btn-sm rounded-pill shadow p-2 font_bold btn-light btn-block mt-5"><i class="fas fa-store"></i> Continuer à shopper des produits</button>
          
          <div class="modal fade" id="exampleModalCenter" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered" role="document">
              <div class="modal-content border-light" style="border-radius: 19px;">
                <div class="modal-header">
                  <h2 class="modal-title font_bold" id="exampleModalCenterTitle">Validation du commande</h2>
                  <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                  </button>
                </div>
                <div *ngIf="!ordersnotfound" class="modal-body">
                  Vous etes d'accord pour cette commande ?
                </div>
                <div *ngIf="ordersnotfound" class="modal-body text-danger">
                  Votre panier est vide
                </div>
                <div class="modal-footer">
                  <button *ngIf="!ordersnotfound" type="button" class="btn btn-light rounded-pill shadow font_bold" style="font-size: 14px;" data-dismiss="modal">Non, Fermer</button>
                  <button *ngIf="ordersnotfound" type="button" class="btn btn-light rounded-pill shadow font_bold" style="font-size: 14px;" data-dismiss="modal">Fermer</button>
                  <button *ngIf="!ordersnotfound" type="button" (click)="addorderdetail()" data-dismiss="modal" class="btn rounded-pill btncommande font_bold shadow" style="font-size: 14px;">Oui, Commander</button>
                  <button *ngIf="ordersnotfound" type="button" [routerLink]="['/all-products']" data-dismiss="modal" class="btn rounded-pill shadow btncommande font_bold" style="font-size: 14px;">Remplir mon panier</button>
                </div>
              </div>
            </div>
          </div>
   
   
        </div>
  </div>
      </div>
  </div>

</div>